<!doctype html>
<html lang="en">

<head>
    <title>Title</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS v5.2.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>
    <header>
        <!-- place navbar here -->
    </header>
    <main>
        <div class="progress  my-5   " style="height: 4vh;">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-danger  " role="progressbar"
                style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="1000" id="progresse">Niveau
            </div>
        </div>

        <!-- Modal trigger button -->
        <button id="modal_1" type="button" class="btn btn-danger btn-lg d-none" data-bs-toggle="modal"
            data-bs-target="#modalId">
            Launch
        </button>

        <!-- Modal Body -->
        <!-- if you want to close by clicking outside the modal, delete the last endpoint:data-bs-backdrop and data-bs-keyboard -->
        <div class="modal fade" id="modalId" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false"
            role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-sm" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalTitleId">Modal niveau </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="code" class="form-label">Entrer le code</label>
                            <input type="text" class="form-control" name="" id="code" aria-describedby="helpId"
                                placeholder="">
                            <small id="helpId" class="form-text text-danger mb-5 d-none">Veillez entrer le bon
                                code</small>

                        </div>
                        <div class="row">
                            <a class="btn btn-danger align-content-center text-center mt-5 " href="javascript:void(0)"
                                role="button" id="checkCode">Validé</a>

                        </div>


                    </div>
                    <div class="modal-footer d-none">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                            id="close">Close</button>
                        <button type="button" class="btn btn-danger">Save</button>
                    </div>
                </div>
            </div>
        </div>




        <!-- Button trigger modal -->
        <button type="button" id="modalSuccess" class="btn btn-danger btn-lg d-none" data-bs-toggle="modal"
            data-bs-target="#ModalSuccess">
            Launch
        </button>

        <!-- Modal -->
        <div class="modal fade" id="ModalSuccess" tabindex="-1" role="dialog" aria-labelledby="modalTitleId"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalTitleIdSuccess"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            Merci pour la confiance
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <script>
            var modalId = document.getElementById('modalId');

            modalId.addEventListener('show.bs.modal', function (event) {
                // Button that triggered the modal
                let button = event.relatedTarget;
                // Extract info from data-bs-* attributes
                let recipient = button.getAttribute('data-bs-whatever');

                // Use above variables to manipulate the DOM
            });


            // Vérifie si l'on écrit dans le champ de saisie
            document.getElementById('code').addEventListener('keyup', () => {
                document.getElementById('helpId').classList.contains('d-none') ? '' : document.getElementById('helpId').classList.add('d-none');

            })
        </script>



        <!-- Optional: Place to the bottom of scripts -->
        <script>
            // const myModal = new bootstrap.Modal(document.getElementById('modalId'), options)

            let progress = document.getElementById('progresse');
            niveau = 0;
            var etape = 0;

            let niveau1 = setInterval(() => {
                niveau += 1

                if (niveau <= 40) {
                    progress.style.width = `${niveau}%`;
                    progress.textContent = `${niveau}%`;
                }

                if (niveau === 40) {
                    etape = 1;
                    document.getElementById('modalTitleId').textContent = `Modal du niveau 1`
                    document.getElementById('modal_1').click();
                    clearInterval(niveau1);
                }
            }, 1000);


            document.getElementById('checkCode').addEventListener('click', () => {

                if (etape === 1) {
                    let code = document.getElementById('code').value;

                    if (code === '4444') {
                        document.getElementById('helpId').classList.contains('d-none') ? '' : document.getElementById('helpId').classList.add('d-none');
                        document.getElementById('close').click();
                        let niveau2 = setInterval(() => {
                            niveau += 1;
                            if (niveau <= 60) {
                                progress.style.width = `${niveau}%`;
                                progress.textContent = `${niveau}%`;
                            }

                            if (niveau === 60) {
                                etape = 2;
                                document.getElementById('code').value = '';
                                document.getElementById('modalTitleId').textContent = `Modal du niveau 2`
                                document.getElementById('modal_1').click();
                                clearInterval(niveau2);
                            }
                        }, 1000);
                    }
                    else {
                        // document.getElementById('modal_1').click();
                        document.getElementById('helpId').classList.contains('d-none') ? document.getElementById('helpId').classList.remove('d-none') : '';

                    }
                } else if (etape == 2) {
                    let code = document.getElementById('code').value;
                    if (code === '8888') {
                        document.getElementById('helpId').classList.contains('d-none') ? '' : document.getElementById('helpId').classList.add('d-none');
                        document.getElementById('close').click();
                        let niveau3 = setInterval(() => {
                            niveau += 1;
                            if (niveau <= 80) {
                                progress.style.width = `${niveau}%`;
                                progress.textContent = `${niveau}%`;
                            }

                            if (niveau === 80) {
                                etape = 3;
                                document.getElementById('code').value = '';
                                document.getElementById('modalTitleIdSuccess').textContent = `Info`
                                document.getElementById('modal_1').click();
                                clearInterval(niveau3);
                            }
                        }, 1000);
                    }
                    else {
                        // document.getElementById('modal_1').click();
                        document.getElementById('helpId').classList.contains('d-none') ? document.getElementById('helpId').classList.remove('d-none') : '';
                    }
                }
                else if (etape == 3) {
                    let code = document.getElementById('code').value;
                    if (code === '9999') {
                        document.getElementById('helpId').classList.contains('d-none') ? '' : document.getElementById('helpId').classList.add('d-none');
                        document.getElementById('close').click();
                        let niveau4 = setInterval(() => {
                            niveau += 1;
                            if (niveau <= 90) {
                                progress.style.width = `${niveau}%`;
                                progress.textContent = `${niveau}%`;
                            }

                            if (niveau === 90) {
                                etape = 4;
                                document.getElementById('code').value = '';
                                document.getElementById('modalTitleIdSuccess').textContent = `Info`
                                // document.getElementById('modalSuccess').click();
                                clearInterval(niveau4);

                                // Pour afficher le message de success

                                // Swal.fire(
                                //     'Good job!',
                                //     'You clicked the button!',
                                //     'success'
                                // )


                                // Pour afficher un message d'erreur

                                Swal.fire({
                                    icon: 'error',
                                    title: 'Oops...',
                                    text: "Une erreur s'est produite lors du traitement",
                                })
                            }
                        }, 1000);
                    }
                    else {
                        // document.getElementById('modal_1').click();
                        document.getElementById('helpId').classList.contains('d-none') ? document.getElementById('helpId').classList.remove('d-none') : '';
                    }
                }

            }
            )


        </script>
    </main>
    <footer>
        <!-- place footer here -->
    </footer>
    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous">
        </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
        integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous">
        </script>
</body>

</html>